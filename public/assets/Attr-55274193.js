import{d as M,as as z,ae as P,at as G,r as k,au as H,a as X,o as _,c as v,b as a,w as D,P as N,f as d,e as s,g as m,H as K,G as Q,D as w,J as I,av as R,aw as W,ax as L,ay as Y,az as Z,m as f,X as O,aA as aa,aB as ea,ag as ta,aC as sa,t as la,ah as ia,F as na,ai as oa,ad as ca,q as ra,s as da,x as ua}from"./index-875aa0db.js";/* empty css                        */import"./el-tooltip-4ed993c7.js";const ma=["onClick"],ga=M({__name:"Attr",setup(fa){const o=z();P(()=>{o.$reset()}),G(()=>o.classification3Id,t=>{typeof t=="number"&&g()});const C=k([]),g=async()=>{const{classification1Id:t,classification2Id:n,classification3Id:u}=o,i=await H(t,n,u);C.value=i.data},A=t=>{o.isAddOrEditClassificationData="attr",Object.assign(e,JSON.parse(JSON.stringify(t)))},B=async t=>{(await Z(t.id)).code===200?(f({type:"success",message:"删除成功"}),g()):f({type:"error",message:"删除失败"})},b=()=>{o.isAddOrEditClassificationData="",Object.assign(e,{name:"",attrId:"",attrValueList:[]})},e=X({name:"",attrId:"",attrValueList:[]}),S=()=>{e.attrValueList.push({valueName:"",flag:!0}),O(()=>{y.value[y.value.length-1].focus()})},x=async()=>{e.id="";const{classification1Id:t,classification2Id:n,classification3Id:u}=o;(await aa(e,t,n,u)).code===200?(o.isAddOrEditClassificationData="",f({type:"success",message:e.id?"修改成功":"添加成功"}),g()):f({type:"error",message:e.id?"修改失败":"添加失败"}),Object.assign(e,{name:"",attrId:"",attrValueList:[]})},$=(t,n)=>{if(t.valueName.trim()===""){e.attrValueList.splice(n,1),f({type:"warning",message:"输入内容不能为空！！！"});return}if(e.attrValueList.find(i=>{if(i!==t)return i.valueName===t.valueName})){e.attrValueList.splice(n,1),f({type:"warning",message:"输入内容不能重复！！！"});return}t.flag=!1},T=(t,n)=>{t.flag=!0,O(()=>{y.value[n].focus()})},y=k([]);return(t,n)=>{const u=ea,i=ta,q=sa,r=la,F=ia,U=na,h=oa,V=ca,E=ra,j=da,J=ua;return _(),v("div",null,[a(u,{administrativeName:"attr"}),D(a(V,{shadow:"always",style:{"margin-top":"10vh"}},{default:s(()=>[a(h,{stripe:"",style:{width:"100%"},data:C.value},{empty:s(()=>[a(U,{name:"commoditymanagement-attr-nodataavailable",width:"100%",height:"100%"}),m(" 暂无数据 ")]),default:s(()=>[a(i,{label:"序号",width:"80",type:"index"}),a(i,{prop:"name",label:"属性名称",width:"180"}),a(i,{prop:"address",label:"属性值名称"},{default:s(({row:l})=>[(_(!0),v(K,null,Q(l.attrValueList,c=>(_(),w(q,{key:c.id,type:"success",style:{"margin-right":"1vw","margin-bottom":"1vh"}},{default:s(()=>[m(I(c.valueName),1)]),_:2},1024))),128))]),_:1}),a(i,{label:"操作",width:"180"},{default:s(({row:l})=>[a(r,{icon:d(R),type:"primary",plain:"",onClick:c=>A(l)},null,8,["icon","onClick"]),a(F,{title:`您确定要删除${l.name}属性吗？`,width:"300",onConfirm:c=>B(l)},{reference:s(()=>[a(r,{icon:d(W),type:"primary",plain:""},null,8,["icon"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1},512),[[N,d(o).isAddOrEditClassificationData===""]]),D(a(V,{shadow:"always",style:{"margin-top":"10vh"}},{default:s(()=>[a(J,{inline:""},{default:s(()=>[a(j,{label:"属性名称"},{default:s(()=>[a(E,{placeholder:"请您输入属性名称",modelValue:e.name,"onUpdate:modelValue":n[0]||(n[0]=l=>e.name=l)},null,8,["modelValue"])]),_:1})]),_:1}),a(r,{type:"primary",icon:d(L),onClick:S,disabled:!e.name},{default:s(()=>[m("添加属性值")]),_:1},8,["icon","disabled"]),a(r,{type:"primary",onClick:b},{default:s(()=>[m("取消")]),_:1}),a(h,{border:"",style:{margin:"5vh 0 5vh 0"},data:e.attrValueList},{default:s(()=>[a(i,{label:"序号",width:"80",align:"center",type:"index"}),a(i,{label:"属性值名称"},{default:s(({row:l,$index:c})=>[l.flag?(_(),w(E,{key:0,ref:p=>y.value[c]=p,placeholder:"请输入属性名称",modelValue:l.valueName,"onUpdate:modelValue":p=>l.valueName=p,onBlur:p=>$(l,c),size:"small"},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(_(),v("div",{key:1,onClick:p=>T(l,c)},I(l.valueName),9,ma))]),_:1}),a(i,{label:"属性值操作"},{default:s(({$index:l})=>[a(r,{type:"primary",icon:d(Y),onClick:c=>e.attrValueList.splice(l,1)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"]),a(r,{type:"primary",icon:d(L),onClick:x,disabled:!e.attrValueList.length},{default:s(()=>[m("保存")]),_:1},8,["icon","disabled"]),a(r,{type:"primary",onClick:b},{default:s(()=>[m("取消")]),_:1})]),_:1},512),[[N,d(o).isAddOrEditClassificationData==="attr"]])])}}});export{ga as default};
