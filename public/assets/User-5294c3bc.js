import{af as _,d as oe,B as ne,r as u,a as se,o as U,c as q,b as a,e as t,g as d,D as S,K as re,H as ue,G as de,J as ie,X as T,m as w,q as pe,s as ce,t as me,x as fe,ad as ve,ag as _e,ah as ge,ai as be,aj as ye,ak as Ve,al as we,am as Ce,y as ke,z as Ue,A as Ie,_ as he}from"./index-5fcb086d.js";/* empty css                        *//* empty css                      */import"./el-tooltip-4ed993c7.js";const xe=(s,c,i)=>_.get(`/user/getall/${s}/${c}/?username=${i}`),Ee=s=>s.id?_.post("/user/update",s):_.post("/user/add",s),Ne=s=>_.get(`/user/positioninfo/${s}`),$e=s=>_.post("user/assignedpost",s),Pe=s=>_.get(`/user/delete/${s}`),ze=s=>_.post("/user/deleteall",s),Ae=s=>(ke("data-v-14302424"),s=s(),Ue(),s),De=Ae(()=>Ie("h4",null,"分配职位",-1)),qe=oe({__name:"User",setup(s){ne(()=>{c()});const c=async(n=1)=>{i.value=n;const e=await xe(i.value,I.value,V.value);e.code===200&&(C.value=e.data.records,$.value=e.data.total)},i=u(1),I=u(5),$=u(100),C=u([]),j=()=>{c()},g=u(!1),B=()=>{g.value=!0,Object.assign(o,{id:"",userName:"",accountnumber:"",password:""}),T(()=>{k.value.clearValidate()})},O=n=>{g.value=!0,Object.assign(o,n),T(()=>{k.value.clearValidate()})},F=async()=>{const{code:n}=await ze(E.value);n===200&&(w({type:"success",message:"批量删除成功"}),c(C.value.length>1?i.value:i.value-1))},o=se({userName:"",accountnumber:"",password:""}),G=async()=>{await k.value.validate();const{code:n}=await Ee(o);n===200?(g.value=!1,w({type:"success",message:o.id?"更新成功":"添加成功"}),window.location.reload()):w({type:"success",message:o.id?"更新失败":"添加失败"})},L=async()=>{g.value=!1},R=(n,e,r)=>{o.userName.trim().length>=2?r():r(new Error("名称至少2位！！！"))},K=(n,e,r)=>{o.accountnumber.trim().length>=5?r():r(new Error("账号长度至少5位！！！"))},M=(n,e,r)=>{o.password.trim().length>=5?r():r(new Error("密码长度至少5位！！！"))},k=u(),H={userName:[{required:!0,trigger:"blur",validator:R}],accountnumber:[{required:!0,trigger:"blur",validator:K}],password:[{required:!0,trigger:"blur",validator:M}]},b=u(!1),J=async n=>{b.value=!0,Object.assign(o,n);const e=await Ne(o.id);e.code===200&&(f.value=e.data.userPosition.map(r=>r.id),y.value=e.data.allPosition)},h=u(!1),x=u(!0),f=u([]),y=u([]),X=n=>{f.value=n?y.value.map(e=>e.id):[],x.value=!1},Q=n=>{h.value=n&&y.value.length===f.value.length,x.value=f.value.length>0&&f.value.length<y.value.length},W=async()=>{const{code:n}=await $e({userId:o.id,positionIdList:f.value});n===200&&(b.value=!1,w({type:"success",message:"分配职位成功"}),c(i.value))},Y=async n=>{const{code:e}=await Pe(n);e===200&&(w({type:"success",message:"删除成功"}),c(C.value.length>1?i.value:i.value-1))},E=u([]),Z=n=>{E.value=n.map(e=>e.id)},V=u("");return(n,e)=>{const r=pe,v=ce,p=me,N=fe,P=ve,m=_e,ee=ge,ae=be,le=ye,z=Ve,A=we,te=Ce;return U(),q("div",null,[a(P,null,{default:t(()=>[a(N,{inline:"",style:{display:"flex","justify-content":"space-between"}},{default:t(()=>[a(v,{label:"用户名"},{default:t(()=>[a(r,{placeholder:"搜索用户名",modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=l=>V.value=l)},null,8,["modelValue"])]),_:1}),a(v,null,{default:t(()=>[a(p,{type:"primary",disabled:!V.value,onClick:e[1]||(e[1]=l=>{c(),V.value=""})},{default:t(()=>[d("搜索")]),_:1},8,["disabled"]),a(p,{type:"primary",onClick:e[2]||(e[2]=l=>c())},{default:t(()=>[d("重置")]),_:1})]),_:1})]),_:1})]),_:1}),a(P,{style:{"margin-top":"5vh"}},{default:t(()=>[a(p,{type:"primary",onClick:B},{default:t(()=>[d("添加用户")]),_:1}),a(p,{type:"primary",onClick:F,disabled:!(E.value.length>0)},{default:t(()=>[d("批量删除")]),_:1},8,["disabled"]),a(ae,{border:"",data:C.value,onSelectionChange:Z,style:{"margin-top":"2vh"}},{default:t(()=>[a(m,{type:"selection",align:"center",width:"50"}),a(m,{label:"#",align:"center",type:"index",width:"70"}),a(m,{label:"ID",align:"center",prop:"id",width:"70"}),a(m,{label:"用户名称",prop:"userName",width:"100"}),a(m,{label:"用户账号",prop:"accountnumber"}),a(m,{label:"密码",prop:"password"}),a(m,{label:"创建时间",prop:"createTime"}),a(m,{label:"更新时间",prop:"updateTime"}),a(m,{label:"操作",width:"220"},{default:t(({row:l})=>[a(p,{type:"primary",size:"small",onClick:D=>J(l)},{default:t(()=>[d("分配职位")]),_:2},1032,["onClick"]),a(p,{type:"primary",size:"small",onClick:D=>O(l)},{default:t(()=>[d("编辑")]),_:2},1032,["onClick"]),a(ee,{width:"220","confirm-button-text":"OK","cancel-button-text":"No, Thanks","icon-color":"#626AEF",title:`您确定要删除${l.userName}`,onConfirm:D=>Y(l.id)},{reference:t(()=>[a(p,{type:"primary",size:"small"},{default:t(()=>[d("删除")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(le,{"current-page":i.value,"onUpdate:currentPage":[e[3]||(e[3]=l=>i.value=l),c],"page-size":I.value,"onUpdate:pageSize":[e[4]||(e[4]=l=>I.value=l),j],"page-sizes":[5,7,9,11],background:"",layout:"prev, pager, next, jumper,->,sizes,total",total:$.value},null,8,["current-page","page-size","total"])]),_:1}),a(z,{modelValue:g.value,"onUpdate:modelValue":e[9]||(e[9]=l=>g.value=l),title:o.id?"更新用户":"添加用户"},{default:t(()=>[a(N,{modelValue:o,"onUpdate:modelValue":e[8]||(e[8]=l=>o=l),rules:H,ref_key:"formRef",ref:k},{default:t(()=>[a(v,{label:"用户名称",prop:"userName"},{default:t(()=>[a(r,{placeholder:"请输入名称",modelValue:o.userName,"onUpdate:modelValue":e[5]||(e[5]=l=>o.userName=l)},null,8,["modelValue"])]),_:1}),a(v,{label:"用户账号",prop:"accountnumber",style:{margin:"7vh 0"}},{default:t(()=>[a(r,{placeholder:"请输入账号",modelValue:o.accountnumber,"onUpdate:modelValue":e[6]||(e[6]=l=>o.accountnumber=l)},null,8,["modelValue"])]),_:1}),o.id?re("",!0):(U(),S(v,{key:0,label:"用户密码",prop:"password"},{default:t(()=>[a(r,{placeholder:"请输入密码",modelValue:o.password,"onUpdate:modelValue":e[7]||(e[7]=l=>o.password=l)},null,8,["modelValue"])]),_:1}))]),_:1},8,["modelValue"])]),footer:t(()=>[a(p,{type:"primary",onClick:L},{default:t(()=>[d("取消")]),_:1}),a(p,{type:"primary",onClick:G},{default:t(()=>[d("确定")]),_:1})]),_:1},8,["modelValue","title"]),a(z,{modelValue:b.value,"onUpdate:modelValue":e[14]||(e[14]=l=>b.value=l)},{header:t(()=>[De]),default:t(()=>[a(N,null,{default:t(()=>[a(v,{label:"用户名称"},{default:t(()=>[a(r,{placeholder:"请输入名称",modelValue:o.userName,"onUpdate:modelValue":e[10]||(e[10]=l=>o.userName=l),disabled:!0},null,8,["modelValue"])]),_:1}),a(v,{label:"职位列表"},{default:t(()=>[a(A,{modelValue:h.value,"onUpdate:modelValue":e[11]||(e[11]=l=>h.value=l),indeterminate:x.value,onChange:X},{default:t(()=>[d("全选")]),_:1},8,["modelValue","indeterminate"]),a(te,{modelValue:f.value,"onUpdate:modelValue":e[12]||(e[12]=l=>f.value=l)},{default:t(()=>[(U(!0),q(ue,null,de(y.value,l=>(U(),S(A,{key:l.id,label:l.id,onChange:Q,checked:!1},{default:t(()=>[d(ie(l.jobTitle),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),footer:t(()=>[a(p,{type:"primary",onClick:e[13]||(e[13]=l=>b.value=!1)},{default:t(()=>[d("取消")]),_:1}),a(p,{type:"primary",onClick:W},{default:t(()=>[d("确定")]),_:1})]),_:1},8,["modelValue"])])}}});const Oe=he(qe,[["__scopeId","data-v-14302424"]]);export{Oe as default};
