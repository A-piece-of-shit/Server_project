import{af as f,d as Q,B as W,r as u,a as Y,o as B,D as z,e as l,b as o,A as v,J as Z,f as h,ap as ee,g as ae,c as te,w as oe,P as ne,m as w,ag as re,F as le,ah as se,ai as de,aj as ie,q as me,s as ce,aq as ge,x as ue,ar as pe,t as be,ak as _e,ad as fe,_ as ve}from"./index-5fcb086d.js";/* empty css                      *//* empty css                    *//* empty css                        */import"./el-tooltip-4ed993c7.js";import{b as he}from"./time-3a5ddd55.js";const we=(s,_)=>f.get(`/manage/brand/${s}/${_}`),ye=s=>s.id?f.post("/manage/updatebrand",s):f.post("/manage/addbrand",s),y=s=>f.get(`/manage/cancel/upload/${s}`),xe=s=>f.get(`/manage/deletebrand/${s}`),Le=["src"],Ie={style:{position:"fixed",right:"4vw",bottom:"10vh","z-index":"2"}},Be=["src"],Ee=Q({__name:"Trademark",setup(s){W(()=>{p()});const _="http://47.243.253.162/development",C=async e=>{if(d.value==="新增品牌")if(t.brandLogoImg)try{(await y(t.brandLogoImg.slice(53))).code===200&&e()}catch{}else e();else{if(t.brandLogoImg!==m)try{await y(t.brandLogoImg.slice(53))}catch{}I="",m="",t.brandLogoImg="",e()}},i=u(1),x=u(3),E=u(0),L=u([]),t=Y({creationDate:"",editDate:"",brandName:"",brandLogoImg:"",brandLogoFilename:"",brandLogoSize:0}),U=e=>e.type==="image/webp"||e.type==="image/jpeg"||e.type==="image/png"||e.type==="image/gif"?e.size/1024/1024<4?!0:(w({showClose:!0,message:"上传文件大小必须小于4M！！！",type:"error"}),!1):(w({showClose:!0,message:"上传文件格式错误！！！",type:"error"}),!1),V=(e,a)=>{d.value==="新增品牌"?(t.brandLogoImg=e.data,t.brandLogoFilename=a.name,t.brandLogoSize=a.size,t.creationDate=he(),t.editDate=t.creationDate):(t.brandLogoImg=e.data,t.brandLogoFilename=a.name,t.brandLogoSize=a.size),c.value.clearValidate()},$=async()=>{try{if(await c.value.validate(),t.brandName===I&&t.brandLogoImg===m){b.value=!1;return}(await ye(t)).code===200?(b.value=!1,w({showClose:!0,message:d.value==="新增品牌"?"添加成功":"编辑成功",type:"success"}),d.value==="新增品牌"?p():p(i.value)):w({showClose:!0,message:d.value==="新增品牌"?"添加成功":"编辑成功",type:"error"}),d.value==="编辑品牌"&&m!==""&&(await y(m.slice(53)),m="")}catch{}},p=async(e=1)=>{i.value=e;const a=await we(i.value,x.value);a.code===200&&(E.value=a.total,L.value=a.data)},k=e=>{p(e)},S=()=>{p()},b=u(!1),d=u("新增品牌"),D=()=>{var e,a;b.value=!0,d.value="新增品牌",t.brandName="",t.brandLogoImg="",t.id=0,(e=c.value)==null||e.clearValidate("brandName"),(a=c.value)==null||a.clearValidate("brandUrl")},q=e=>{var a,r;(a=c.value)==null||a.clearValidate("brandName"),(r=c.value)==null||r.clearValidate("brandUrl"),d.value="编辑品牌",b.value=!0,t.brandName=e.brandName,t.brandLogoImg=e.brandLogoImg,m=e.brandLogoImg,I=e.brandName,Object.assign(t,e)};let m="",I="";const T=async(e,a)=>{console.log(e),await xe(e),p(L.value.length>1?i.value:i.value-1),await y(a.slice(53))},c=u(),A={brandName:[{required:!0,trigger:"blur",validator:(e,a,r)=>{a===""?r(new Error("品牌名称不能为空！！！")):r()}}],brandUrl:[{required:!0,trigger:"change",validator:(e,a,r)=>{t.brandLogoImg?r():r(new Error("请选择一张图片"))}}]};return(e,a)=>{const r=re,g=le,P=se,j=de,M=ie,O=me,N=ce,R=ge,J=ue,X=pe,F=be,G=_e,H=fe;return B(),z(H,{class:"box-card"},{default:l(()=>[o(j,{style:{width:"100%"},stripe:"",border:"",size:"large",data:L.value},{default:l(()=>[o(r,{prop:"date",label:"序号",width:"80","header-align":"center",type:"index"}),o(r,{prop:"name",label:"名称",width:"180"},{default:l(({row:n})=>[v("span",null,Z(n.brandName),1)]),_:1}),o(r,{prop:"address",label:"logo",width:"500"},{default:l(({row:n})=>[v("img",{src:`${h(_)}/${n.brandLogoImg}`,alt:"logo",style:{height:"300px","margin-left":"50%",transform:"translateX(-50%)"}},null,8,Le)]),_:1}),o(r,{prop:"address",label:"操作"},{default:l(({row:n})=>[v("div",null,[o(g,{name:"commoditymanagement-brand-editor",width:"30px",height:"30px",style:{"margin-right":"2vw"},onClick:K=>q(n)},null,8,["onClick"]),o(P,{width:"300","confirm-button-text":"确定","cancel-button-text":"取消",title:"确定删除该品牌吗?",icon:h(ee),"icon-color":"#626AEF",onConfirm:K=>T(n.id,n.brandLogoImg)},{reference:l(()=>[o(g,{name:"commoditymanagement-brand-delete",width:"30px",height:"30px"})]),_:2},1032,["icon","onConfirm"])])]),_:1})]),_:1},8,["data"]),o(M,{background:"","page-size":x.value,"onUpdate:pageSize":[a[0]||(a[0]=n=>x.value=n),S],"current-page":i.value,"onUpdate:currentPage":[a[1]||(a[1]=n=>i.value=n),k],"page-sizes":[3,4,5],layout:"prev, pager, next, jumper, ->, sizes, total",total:E.value,style:{"margin-top":"20px"}},null,8,["page-size","current-page","total"]),v("div",Ie,[o(g,{name:"commoditymanagement-brand-append",width:"30px",height:"30px",onClick:D})]),o(G,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=n=>b.value=n),title:d.value,size:"40%","before-close":C},{footer:l(()=>[o(F,{onClick:$},{default:l(()=>[ae(" 确认"),o(g,{name:"commoditymanagement-brand-confirmation",width:"30px",height:"30px"})]),_:1})]),default:l(()=>[o(J,{model:t,"label-width":"120px",ref_key:"formRef",ref:c,rules:A},{default:l(()=>[o(g,{name:"commoditymanagement-brand-brand",width:"30px",height:"30px",style:{position:"absolute",margin:"1px 0 0 10px"}}),o(N,{label:"品牌名称",prop:"brandName"},{default:l(()=>[o(O,{modelValue:t.brandName,"onUpdate:modelValue":a[2]||(a[2]=n=>t.brandName=n)},null,8,["modelValue"])]),_:1}),o(g,{name:"commoditymanagement-brand-addingimages",width:"30px",height:"30px",style:{position:"absolute",margin:"1px 0 0 10px"}}),o(N,{label:"品牌图片",prop:"brandUrl"},{default:l(()=>[o(R,{class:"avatar-uploader",action:h(_)+"/manage/brand/uploadingimages",headers:{enctype:"multipart/form-data"},"show-file-list":!1,"on-success":V,"before-upload":U},{default:l(()=>[t.brandLogoImg?(B(),te("img",{key:0,src:`${h(_)}/${t.brandLogoImg}`,class:"avatar"},null,8,Be)):(B(),z(g,{key:1,name:"commoditymanagement-brand-add",width:"3vw",height:"8vh",class:"avatar-uploader-icon"}))]),_:1},8,["action"])]),_:1})]),_:1},8,["model"]),oe(o(X,{title:"点击图片进行更换",type:"success",center:""},null,512),[[ne,t.brandLogoImg]])]),_:1},8,["modelValue","title"])]),_:1})}}});const De=ve(Ee,[["__scopeId","data-v-50601467"]]);export{De as default};
